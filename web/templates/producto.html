{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Productos - Athlos</title>
  <script src="https://kit.fontawesome.com/64d58efce2.js" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="{% static 'css/navstyles.css' %}">
  <!-- Bootstrap CSS (for navbar) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/producto.css' %}">

 
</head>
<body>

  <!-- ---------- HEADER ---------- -->
  {% include 'navbar.html' %}

  <!-- ---------- SECCIÓN DE PRODUCTOS ---------- -->
  <section class="productos-container">

    <!-- PRODUCTO 1 -->
    <div class="producto-card">
      <div class="producto-imagen">
          <img src="{% static 'img/camisetadeport.jpg' %}" alt="Camiseta deportiva Athlos">
        </div>
      <div class="producto-info">
        <h2>Camiseta Deportiva Athlos</h2>
        <p>Tejido transpirable con diseño ergonómico ideal para entrenamientos intensos.</p>
      <div class="producto-precio">$79.900</div>
      <button class="producto-btn" data-name="Camiseta Deportiva Athlos" data-price="79900" data-image="{% static 'img/camisetadeport.jpg' %}" onclick="agregarAlCarritoFromBtn(this)"><i class="fas fa-cart-plus"></i> Añadir al carrito</button>
      </div>
    </div>

    <!-- PRODUCTO 2 -->
    <div class="producto-card">
        <div class="producto-imagen">
        <img src="{% static 'img/pantaloneta.jpg' %}" alt="Pantaloneta deportiva Athlos">
      </div>
      <div class="producto-info">
        <h2>Pantaloneta Deportiva Athlos</h2>
        <p>Con tecnología DryFit que mantiene la frescura durante el entrenamiento.</p>
    <div class="producto-precio">$59.900</div>
    <button class="producto-btn" data-name="Pantaloneta Deportiva Athlos" data-price="59900" data-image="{% static 'img/pantaloneta.jpg' %}" onclick="agregarAlCarritoFromBtn(this)"><i class="fas fa-cart-plus"></i> Añadir al carrito</button>
      </div>
    </div>

    <!-- PRODUCTO 3 -->
    <div class="producto-card">
      <div class="producto-imagen">
        <img src="{% static 'img/sudadera.jpg' %}" alt="Sudadera Athlos Premium">
      </div>
      <div class="producto-info">
        <h2>Sudadera Athlos Premium</h2>
        <p>Comodidad y estilo con materiales de alta calidad y acabado elegante.</p>
    <div class="producto-precio">$119.900</div>
    <button class="producto-btn" data-name="Sudadera Athlos Premium" data-price="119900" data-image="{% static 'img/sudadera.jpg' %}" onclick="agregarAlCarritoFromBtn(this)"><i class="fas fa-cart-plus"></i> Añadir al carrito</button>
      </div>
    </div>

  </section>

  <!-- ---------- BOTÓN VOLVER AL INICIO ---------- -->
  <a href="{% url 'carritocompras' %}" class="btn-ir-carrito"><i class="fas fa-shopping-cart"></i> Ir al carrito</a>
  <a href="{% url 'index' %}" class="btn-inicio"><i class="fas fa-home"></i> Volver al inicio</a>
    <script src="{% static 'js/navbar.js' %}"></script>
  <!-- Bootstrap JS (bundle includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Mostrar alerta/toast (reusable)
    function mostrarAlerta(mensaje) {
      const alerta = document.createElement('div');
      // aplicar clase unificada y la variante oscura para que el toast del producto
      // use el mismo estilo que el del carrito
      alerta.className = 'alerta-envio alerta-dark';
      alerta.textContent = mensaje;
      document.body.appendChild(alerta);
      setTimeout(() => alerta.remove(), 2500);
    }
    // --- Función para obtener el carrito actual ---
    function obtenerCarrito() {
      return JSON.parse(localStorage.getItem('cart') || '[]');
    }

    // --- Guardar carrito actualizado ---
    function guardarCarrito(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    // --- Wrapper para botones: toma data-* del botón y llama a agregarAlCarrito ---
    function agregarAlCarritoFromBtn(btn) {
      const nombre = btn.dataset.name || '';
      const precio = Number(btn.dataset.price) || 0;
      const imagen = btn.dataset.image || '';
      agregarAlCarrito(nombre, precio, imagen);
    }

    // --- Agregar producto al carrito ---
    function agregarAlCarrito(nombre, precio, imagen) {
      const carrito = obtenerCarrito();

      // Verificar si ya existe el producto
      const existente = carrito.find(p => p.name === nombre);
      if (existente) {
        existente.qty += 1; // Aumenta cantidad si ya está
      } else {
        carrito.push({ name: nombre, price: precio, image: imagen, qty: 1 });
      }

      guardarCarrito(carrito);

      // Mostrar mensaje sin redirigir
      mostrarAlerta('Producto agregado al carrito correctamente');
    }
  </script>

</body>
</html>
